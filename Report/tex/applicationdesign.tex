\chapter{Application Design}
\label{chap:design}
In this chapter, the considerations made when designing the system are outlined. Additionally, the metamodel for the survey specification language is presented.

\section{Metamodel}
\label{sec:metamodel}
This section presents the domain model for the application. Majority of objects presented in model are described in glossary. This model is supposed to support all the examples (sometimes with small extensions, e.g. to DataType class). It consists of two main parts - Survey Scheme, that will reflect the DSL structure and Survey Instance, that store the user answers from each time the survey has been filled in.

\begin{figure}[!htbp]
  \includegraphics[scale=0.45]{\imgdir "meta-model"}
  \caption{Metamodel for the survey DSL.}
  \label{fig:metamodel}
\end{figure}

%TODO write more about model

\section{Design Considerations}
\label{sec:designconsiderations}
%TODO section intro
%TODO this section needs a lot more written in it
When running a survey on the phone, the user will expect the questions to be stored intermediately, allowing him/her to navigate back and forth between questions without discarding the answers already typed in.

\begin{figure}[!htbp]
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries}]

  \node[main node] (1) {$q_1$};
  \node[main node] (2) [below left of=1] {$q_2$};
  \node[main node] (3) [below right of=2] {$q_3$};
  \node[main node] (4) [below right of=1] {$q_4$};
  \node[main node] (5) [below left of=2] {$q_5$};

  \path[every node/.style={font=\sffamily\small}]
    (1) edge node [right] {male} (4)
        edge node [left] {female} (2)
    (2) edge node [right] {single} (3)
        edge node [left] {married} (5);
\end{tikzpicture}
\begin{tikzpicture}[->,>=stealth',shorten >=1pt,auto,node distance=3cm,
  thick,
  main node/.style={circle,fill=blue!20,draw,font=\sffamily\Large\bfseries},
  chosen node/.style={circle,fill=green!20,draw,font=\sffamily\Large\bfseries}]

  \node[chosen node] (1) {$a_1$};
  \node[chosen node] (2) [below left of=1] {$a_2$};
  \node[chosen node] (3) [below right of=2] {$a_3$};
  \node[main node] (4) [below right of=1] {$a_4$};
  \node[main node] (5) [below left of=2] {$a_5$};

  \path[every node/.style={font=\sffamily\small}]
    (1) edge node [right] {male} (4)
        edge node [left] {female} (2)
    (2) edge node [right] {single} (3)
        edge node [left] {married} (5);
\end{tikzpicture}

\end{figure}